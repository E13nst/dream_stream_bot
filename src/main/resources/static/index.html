<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StickerSet API Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .api-section {
            margin-bottom: 30px;
        }
        .api-section h3 {
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        button:hover {
            background-color: #0056b3;
        }
        button.delete {
            background-color: #dc3545;
        }
        button.delete:hover {
            background-color: #c82333;
        }
        .result {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            margin-top: 15px;
            white-space: pre-wrap;
            font-family: monospace;
            max-height: 300px;
            overflow-y: auto;
        }
        .sticker-set-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            background-color: #f9f9f9;
        }
        .sticker-set-card h4 {
            margin: 0 0 10px 0;
            color: #333;
        }
        .sticker-set-info {
            color: #666;
            font-size: 14px;
        }
        .actions {
            margin-top: 10px;
        }
        .actions button {
            padding: 5px 10px;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>üéØ StickerSet REST API Test</h1>
    
    <!-- –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã -->
    <div class="container api-section">
        <h3>üìã –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã</h3>
        <button onclick="getAllStickerSets()">–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ</button>
        <div id="allStickerSets" class="result" style="display: none;"></div>
    </div>
    
    <!-- –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç –ø–æ ID -->
    <div class="container api-section">
        <h3>üîç –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç –ø–æ ID</h3>
        <div class="form-group">
            <label for="getId">ID —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–∞:</label>
            <input type="number" id="getId" placeholder="–í–≤–µ–¥–∏—Ç–µ ID">
        </div>
        <button onclick="getStickerSetById()">–ü–æ–ª—É—á–∏—Ç—å</button>
        <div id="stickerSetById" class="result" style="display: none;"></div>
    </div>
    
    <!-- –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã –ø–æ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
    <div class="container api-section">
        <h3>üë§ –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
        <div class="form-group">
            <label for="getUserId">ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
            <input type="number" id="getUserId" placeholder="–í–≤–µ–¥–∏—Ç–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
        </div>
        <button onclick="getStickerSetsByUserId()">–ü–æ–ª—É—á–∏—Ç—å</button>
        <div id="stickerSetsByUserId" class="result" style="display: none;"></div>
    </div>
    
    <!-- –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é -->
    <div class="container api-section">
        <h3>üîé –ü–æ–∏—Å–∫ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–∞ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é</h3>
        <div class="form-group">
            <label for="searchName">–ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–∞:</label>
            <input type="text" id="searchName" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ">
        </div>
        <button onclick="searchStickerSet()">–ü–æ–∏—Å–∫</button>
        <div id="searchResult" class="result" style="display: none;"></div>
    </div>
    
    <!-- –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç -->
    <div class="container api-section">
        <h3>‚ûï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç</h3>
        <div class="form-group">
            <label for="createUserId">ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
            <input type="number" id="createUserId" placeholder="–í–≤–µ–¥–∏—Ç–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
        </div>
        <div class="form-group">
            <label for="createTitle">–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
            <input type="text" id="createTitle" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ">
        </div>
        <div class="form-group">
            <label for="createName">–ü–æ–ª–Ω–æ–µ –∏–º—è (–¥–ª—è Telegram):</label>
            <input type="text" id="createName" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω–æ–µ –∏–º—è">
        </div>
        <button onclick="createStickerSet()">–°–æ–∑–¥–∞—Ç—å</button>
        <div id="createResult" class="result" style="display: none;"></div>
    </div>
    
    <!-- –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç -->
    <div class="container api-section">
        <h3>‚úèÔ∏è –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç</h3>
        <div class="form-group">
            <label for="updateId">ID —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–∞:</label>
            <input type="number" id="updateId" placeholder="–í–≤–µ–¥–∏—Ç–µ ID">
        </div>
        <div class="form-group">
            <label for="updateTitle">–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ:</label>
            <input type="text" id="updateTitle" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ">
        </div>
        <div class="form-group">
            <label for="updateName">–ù–æ–≤–æ–µ –ø–æ–ª–Ω–æ–µ –∏–º—è:</label>
            <input type="text" id="updateName" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –ø–æ–ª–Ω–æ–µ –∏–º—è">
        </div>
        <button onclick="updateStickerSet()">–û–±–Ω–æ–≤–∏—Ç—å</button>
        <div id="updateResult" class="result" style="display: none;"></div>
    </div>
    
    <!-- –£–¥–∞–ª–∏—Ç—å —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç -->
    <div class="container api-section">
        <h3>üóëÔ∏è –£–¥–∞–ª–∏—Ç—å —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç</h3>
        <div class="form-group">
            <label for="deleteId">ID —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–∞:</label>
            <input type="number" id="deleteId" placeholder="–í–≤–µ–¥–∏—Ç–µ ID">
        </div>
        <button onclick="deleteStickerSet()" class="delete">–£–¥–∞–ª–∏—Ç—å</button>
        <div id="deleteResult" class="result" style="display: none;"></div>
    </div>

    <script>
        const API_BASE = '/api/stickersets';
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
        function showResult(elementId, data, isError = false) {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.style.backgroundColor = isError ? '#f8d7da' : '#d4edda';
            element.style.borderColor = isError ? '#f5c6cb' : '#c3e6cb';
            element.textContent = typeof data === 'object' ? JSON.stringify(data, null, 2) : data;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–æ–≤ –≤ –≤–∏–¥–µ –∫–∞—Ä—Ç–æ—á–µ–∫
        function displayStickerSets(elementId, stickerSets) {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            
            if (!Array.isArray(stickerSets) || stickerSets.length === 0) {
                element.innerHTML = '<p>–°—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>';
                return;
            }
            
            const html = stickerSets.map(set => `
                <div class="sticker-set-card">
                    <h4>${set.title}</h4>
                    <div class="sticker-set-info">
                        <strong>ID:</strong> ${set.id}<br>
                        <strong>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</strong> ${set.userId}<br>
                        <strong>–ü–æ–ª–Ω–æ–µ –∏–º—è:</strong> ${set.name}<br>
                        <strong>–°–æ–∑–¥–∞–Ω:</strong> ${new Date(set.createdAt).toLocaleString()}
                    </div>
                    <div class="actions">
                        <button onclick="editStickerSet(${set.id}, '${set.title}', '${set.name}')">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                        <button onclick="deleteStickerSetById(${set.id})" class="delete">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                    </div>
                </div>
            `).join('');
            
            element.innerHTML = html;
        }
        
        // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã
        async function getAllStickerSets() {
            try {
                const response = await fetch(API_BASE);
                if (response.ok) {
                    const data = await response.json();
                    displayStickerSets('allStickerSets', data);
                } else {
                    showResult('allStickerSets', `–û—à–∏–±–∫–∞: ${response.status} ${response.statusText}`, true);
                }
            } catch (error) {
                showResult('allStickerSets', `–û—à–∏–±–∫–∞: ${error.message}`, true);
            }
        }
        
        // –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç –ø–æ ID
        async function getStickerSetById() {
            const id = document.getElementById('getId').value;
            if (!id) {
                showResult('stickerSetById', '–í–≤–µ–¥–∏—Ç–µ ID —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–∞', true);
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/${id}`);
                if (response.ok) {
                    const data = await response.json();
                    showResult('stickerSetById', data);
                } else if (response.status === 404) {
                    showResult('stickerSetById', '–°—Ç–∏–∫–µ—Ä—Å–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω', true);
                } else {
                    showResult('stickerSetById', `–û—à–∏–±–∫–∞: ${response.status} ${response.statusText}`, true);
                }
            } catch (error) {
                showResult('stickerSetById', `–û—à–∏–±–∫–∞: ${error.message}`, true);
            }
        }
        
        // –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã –ø–æ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        async function getStickerSetsByUserId() {
            const userId = document.getElementById('getUserId').value;
            if (!userId) {
                showResult('stickerSetsByUserId', '–í–≤–µ–¥–∏—Ç–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', true);
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/user/${userId}`);
                if (response.ok) {
                    const data = await response.json();
                    displayStickerSets('stickerSetsByUserId', data);
                } else {
                    showResult('stickerSetsByUserId', `–û—à–∏–±–∫–∞: ${response.status} ${response.statusText}`, true);
                }
            } catch (error) {
                showResult('stickerSetsByUserId', `–û—à–∏–±–∫–∞: ${error.message}`, true);
            }
        }
        
        // –ü–æ–∏—Å–∫ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–∞ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
        async function searchStickerSet() {
            const name = document.getElementById('searchName').value;
            if (!name) {
                showResult('searchResult', '–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è –ø–æ–∏—Å–∫–∞', true);
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/search?name=${encodeURIComponent(name)}`);
                if (response.ok) {
                    const data = await response.json();
                    showResult('searchResult', data);
                } else if (response.status === 404) {
                    showResult('searchResult', '–°—Ç–∏–∫–µ—Ä—Å–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω', true);
                } else {
                    showResult('searchResult', `–û—à–∏–±–∫–∞: ${response.status} ${response.statusText}`, true);
                }
            } catch (error) {
                showResult('searchResult', `–û—à–∏–±–∫–∞: ${error.message}`, true);
            }
        }
        
        // –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç
        async function createStickerSet() {
            const userId = document.getElementById('createUserId').value;
            const title = document.getElementById('createTitle').value;
            const name = document.getElementById('createName').value;
            
            if (!userId || !title || !name) {
                showResult('createResult', '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', true);
                return;
            }
            
            try {
                const response = await fetch(API_BASE, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        userId: parseInt(userId),
                        title: title,
                        name: name
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    showResult('createResult', data);
                    // –û—á–∏—â–∞–µ–º –ø–æ–ª—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è
                    document.getElementById('createUserId').value = '';
                    document.getElementById('createTitle').value = '';
                    document.getElementById('createName').value = '';
                } else {
                    const errorText = await response.text();
                    showResult('createResult', `–û—à–∏–±–∫–∞: ${response.status} ${response.statusText}\n${errorText}`, true);
                }
            } catch (error) {
                showResult('createResult', `–û—à–∏–±–∫–∞: ${error.message}`, true);
            }
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç
        async function updateStickerSet() {
            const id = document.getElementById('updateId').value;
            const title = document.getElementById('updateTitle').value;
            const name = document.getElementById('updateName').value;
            
            if (!id) {
                showResult('updateResult', '–í–≤–µ–¥–∏—Ç–µ ID —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–∞', true);
                return;
            }
            
            if (!title && !name) {
                showResult('updateResult', '–í–≤–µ–¥–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ –ø–æ–ª–µ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è', true);
                return;
            }
            
            const updateData = {};
            if (title) updateData.title = title;
            if (name) updateData.name = name;
            
            try {
                const response = await fetch(`${API_BASE}/${id}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(updateData)
                });
                
                if (response.ok) {
                    const data = await response.json();
                    showResult('updateResult', data);
                } else if (response.status === 404) {
                    showResult('updateResult', '–°—Ç–∏–∫–µ—Ä—Å–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω', true);
                } else {
                    const errorText = await response.text();
                    showResult('updateResult', `–û—à–∏–±–∫–∞: ${response.status} ${response.statusText}\n${errorText}`, true);
                }
            } catch (error) {
                showResult('updateResult', `–û—à–∏–±–∫–∞: ${error.message}`, true);
            }
        }
        
        // –£–¥–∞–ª–∏—Ç—å —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç
        async function deleteStickerSet() {
            const id = document.getElementById('deleteId').value;
            if (!id) {
                showResult('deleteResult', '–í–≤–µ–¥–∏—Ç–µ ID —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–∞', true);
                return;
            }
            
            if (!confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç —Å ID ${id}?`)) {
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/${id}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    showResult('deleteResult', '–°—Ç–∏–∫–µ—Ä—Å–µ—Ç —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω');
                    document.getElementById('deleteId').value = '';
                } else if (response.status === 404) {
                    showResult('deleteResult', '–°—Ç–∏–∫–µ—Ä—Å–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω', true);
                } else {
                    showResult('deleteResult', `–û—à–∏–±–∫–∞: ${response.status} ${response.statusText}`, true);
                }
            } catch (error) {
                showResult('deleteResult', `–û—à–∏–±–∫–∞: ${error.message}`, true);
            }
        }
        
        // –£–¥–∞–ª–∏—Ç—å —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç –ø–æ ID (–¥–ª—è –∫–Ω–æ–ø–æ–∫ –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö)
        async function deleteStickerSetById(id) {
            if (!confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç —Å ID ${id}?`)) {
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/${id}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    alert('–°—Ç–∏–∫–µ—Ä—Å–µ—Ç —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω');
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–æ–≤
                    getAllStickerSets();
                } else {
                    alert(`–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏: ${response.status} ${response.statusText}`);
                }
            } catch (error) {
                alert(`–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç (–∑–∞–ø–æ–ª–Ω—è–µ—Ç –ø–æ–ª—è —Ñ–æ—Ä–º—ã)
        function editStickerSet(id, title, name) {
            document.getElementById('updateId').value = id;
            document.getElementById('updateTitle').value = title;
            document.getElementById('updateName').value = name;
            
            // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ —Ñ–æ—Ä–º–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            document.getElementById('updateId').scrollIntoView({ behavior: 'smooth' });
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = function() {
            getAllStickerSets();
        };
    </script>
</body>
</html> 